name: GFWList Auto-Update

on:
  schedule:
    - cron: '0 12 * * *'  # 12:00 UTC daily
  workflow_dispatch:

permissions:
  contents: write  # Явно выдаем права на запись

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download latest list
        run: curl -sSfL -o gfwlist.txt https://antizapret.prostovpn.org/domains-export.txt

      - name: Commit changes
        uses: EndBug/add-and-commit@v11
        with:
          add: gfwlist.txt
          message: "chore: auto-update gfwlist"
          token: ${{ secrets.GH_TOKEN }}  # Явная передача токена
